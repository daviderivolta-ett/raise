var p=Object.defineProperty;var b=(a,t,e)=>t in a?p(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var o=(a,t,e)=>(b(a,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();async function m(a){try{const t=await fetch(a).then(i=>i.json()),e=t.categories.map(async i=>{const s=i.groups.map(async r=>{try{const c=await fetch(r);if(c.ok)return c.json();throw new Error(`Errore durante il recupero dei dati da ${r}`)}catch(c){return console.error(c),null}});i.groups=await Promise.all(s)});return await Promise.all(e),t}catch(t){throw console.error("Errore durante il recupero dei dati JSON",t),t}}async function A(a){try{const e=await(await fetch(`./images/cluster/cluster-${a}.svg`)).text();return new DOMParser().parseFromString(e,"image/svg+xml")}catch(t){throw console.error(t),t}}class l extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.text=document.createElement("h1"),this.text.innerText="Seleziona i tag a cui sei interessato",this.shadow.append(this.text),this.container=document.createElement("div"),this.shadow.append(this.container),this.input=JSON.parse(this.getAttribute("input")),g(this.input).forEach(s=>{this.chip=document.createElement("app-chip"),this.chip.setAttribute("tag",s),this.container.append(this.chip)}),this.submit=document.createElement("app-submit-tags-btn"),this.shadow.append(this.submit),this.selectAll=document.createElement("app-select-all-tags-btn"),this.shadow.append(this.selectAll),this.reset=document.createElement("app-reset-tags-btn"),this.shadow.append(this.reset),this.clearLocalStorage=document.createElement("button"),this.clearLocalStorage.innerText="Clear local storage",this.shadow.append(this.clearLocalStorage),this.allChips=this.shadow.querySelectorAll("app-chip");let e=[];this.allChips.forEach(s=>{s.addEventListener("chipChanged",r=>{r.detail.newValue=="true"?e.push(r.detail.tag):e=e.filter(c=>c!==r.detail.tag),this.submit.setAttribute("tags",JSON.stringify(e))})}),localStorage.selectedTags&&JSON.parse(localStorage.selectedTags).forEach(r=>{this.allChips.forEach(c=>{c.getAttribute("tag")==r&&c.setAttribute("is-selected","true")})}),this.selectAll.addEventListener("selectAllTags",()=>{this.allChips.forEach(s=>{s.setAttribute("is-selected","true")})}),this.reset.addEventListener("resetTags",()=>{this.allChips.forEach(s=>{s.setAttribute("is-selected","false")})}),this.clearLocalStorage.addEventListener("click",()=>{localStorage.clear(),console.log(localStorage)});const i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("href","./css/tag-selection.css"),this.shadow.append(i)}connectedCallback(){}attributeChangedCallback(t,e,i){i!=e&&t=="input"&&this.render()}}o(l,"observedAttributes",["input"]);customElements.define("app-tag-selection",l);function g(a){let t=[];a.categories.forEach(i=>{i.groups.forEach(s=>{s.layers.forEach(r=>{r.tags&&r.tags.forEach(c=>{t.push(c)})})})});const e=[...new Set(t)];return e.sort(),e}class d extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.getAttribute("is-selected")=="true"?(this.chip.classList.add("selected"),this.checkbox.checked=!0):(this.chip.classList.remove("selected"),this.checkbox.checked=!1)}connectedCallback(){this.shadow.innerHTML=`
            <label for="chip">
                <input type="checkbox" id="chip">
                <span class="chip-title"></span>               
            </label>
            `,this.chip=this.shadow.querySelector("label"),this.span=this.shadow.querySelector("span"),this.checkbox=this.shadow.querySelector("input"),this.hasAttribute("tag")&&(this.span.innerText=this.getAttribute("tag"));const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/chip.css"),this.shadow.append(t),this.checkbox.addEventListener("change",e=>{const i=e.target.checked;this.setAttribute("is-selected",i+"")})}attributeChangedCallback(t,e,i){if(t=="is-selected"&&i!=e){const s=new CustomEvent("chipChanged",{detail:{name:t,newValue:i,oldValue:e,tag:this.getAttribute("tag")}});this.dispatchEvent(s),this.render()}}}o(d,"observedAttributes",["is-selected"]);customElements.define("app-chip",d);class u extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){JSON.parse(this.getAttribute("tags")).length===0?this.btn.disabled=!0:this.btn.disabled=!1}connectedCallback(){this.shadow.innerHTML=`
            <button type="submit">Submit</button>
            `,this.btn=this.shadow.querySelector("button"),this.hasAttribute("tags")||(this.btn.disabled=!0),this.btn.addEventListener("click",()=>{localStorage.setItem("selectedTags",this.getAttribute("tags")),window.location.href="/map.html"});const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/primary-btn.css"),this.shadow.append(t)}attributeChangedCallback(t,e,i){t=="tags"&&i!=e&&this.render()}}o(u,"observedAttributes",["tags"]);customElements.define("app-submit-tags-btn",u);const n=class n extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"}),n.snackbars.push(this)}render(){this.p.innerText=this.getAttribute("text")}connectedCallback(){const t=n.snackbars.indexOf(this);if(this.shadow.innerHTML=`
            <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
            <div class="snackbar">
                <div class="content">
                    <p></p>
                </div>
            </div>
            `,this.setAttribute("is-active","true"),this.hasAttribute("text")||this.setAttribute("text",""),this.hasAttribute("type")||this.setAttribute("type","closable"),this.snackbar=this.shadow.querySelector(".snackbar"),this.content=this.shadow.querySelector(".content"),this.p=this.shadow.querySelector("p"),this.p.innerText=this.getAttribute("text"),this.getAttribute("type")=="closable"&&(this.getAttribute("text")==""&&this.setAttribute("text","Chiudi"),this.button=document.createElement("button"),this.button.innerHTML=`
                <div class="close-icon">
                    <span class="material-symbols-outlined">close</span>
                </div>
                `,this.content.append(this.button),this.button.addEventListener("click",()=>this.setAttribute("is-active","false"))),this.getAttribute("type")=="temporary"){let i;this.hasAttribute("timeout")?i=this.getAttribute("timeout"):i=3e3,this.getAttribute("text")==""&&this.setAttribute("text","Attendere..."),this.bar=document.createElement("div"),this.bar.classList.add("bar-color"),this.bar.style.setProperty("width","100%"),this.snackbar.append(this.bar);let s=100,r=setInterval(()=>{s==0&&(clearInterval(r),this.setAttribute("is-active","false")),s--,this.bar.style.width=s+"%"},i/100)}this.getAttribute("type")=="loader"&&this.getAttribute("text")==""&&this.setAttribute("text","Caricamento...");const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","./css/snackbar.css"),this.shadow.append(e),this.style.setProperty("bottom",`${24+64*t}px`)}attributeChangedCallback(t,e,i){i!=e&&i!=null&&e!=null&&(t=="text"&&this.render(),t=="is-active"&&i=="false"&&this.remove())}disconnectedCallback(){const t=n.snackbars.indexOf(this);t!==-1&&(n.snackbars.splice(t,1),this.updatePosition())}updatePosition(){n.snackbars.forEach((t,e)=>{t.style.setProperty("bottom",`${24+64*e}px`)})}};o(n,"snackbars",[]),o(n,"observedAttributes",["text","is-active"]);let h=n;customElements.define("app-snackbar",h);export{A as a,m as f};
