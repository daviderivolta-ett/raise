var H=Object.defineProperty;var P=(a,t,s)=>t in a?H(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var u=(a,t,s)=>(P(a,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();class J{constructor(){const t=document.querySelector("app-map");this.viewer=new Cesium.Viewer(t,{baseLayerPicker:!1,geocoder:!1,timeline:!1,animation:!1,homeButton:!1,navigationInstructionsInitiallyVisible:!0,navigationHelpButton:!1,sceneModePicker:!1,fullscreenButton:!1}),this.toColor=!1,this.viewer.screenSpaceEventHandler.setInputAction(this.onClick.bind(this),Cesium.ScreenSpaceEventType.LEFT_CLICK)}static getImageryProvider(){return new Cesium.WebMapTileServiceImageryProvider({url:"https://c.basemaps.cartocdn.com/rastertiles/voyager/{TileMatrix}/{TileCol}/{TileRow}.png",layer:"carto-light",style:"default",format:"image/jpeg",maximumLevel:19,tileMatrixSetID:"default",credit:new Cesium.Credit('&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>')})}async onClick(t){const s=this.viewer.scene.pick(t);if(s)return s.id}addLayerWMS(t,s,e){const i=new Cesium.WebMapServiceImageryProvider({url:t,layers:s,parameters:e});this.viewer.imageryLayers.addImageryProvider(i)}removeLayerWMS(t){const s=this.viewer.imageryLayers,e=s.length;for(let i=0;i<e;i++){const o=s.get(i);if(o._imageryProvider._layers===t){s.remove(o);return}}}addLayersWFS(t,s,e){let i="YELLOW",o="YELLOW",r="YELLOW",c=.5;e&&e.color&&(i=e.color.toUpperCase(),o=e.color.toUpperCase(),r=e.color.toUpperCase()),e&&e.opacity&&(c=e.opacity);const l=`${t}?service=WFS&typeName=${s}&outputFormat=application/json&request=GetFeature&srsname=EPSG:4326`;fetch(l).then(n=>n.json()).then(n=>{this.viewer.dataSources.add(Cesium.GeoJsonDataSource.load(n,{stroke:Cesium.Color[i].withAlpha(parseFloat(c)),strokeWidth:2,fill:Cesium.Color[o].withAlpha(parseFloat(c))})).then(b=>{b.entities.values.forEach(h=>{h.billboard=void 0,h.point=new Cesium.PointGraphics({pixelSize:18,color:Cesium.Color[r].withAlpha(parseFloat(c)),outlineColor:Cesium.Color[r].withAlpha(parseFloat(c)),outlineWidth:2})})})})}removeLayerWFS(t){const s=this.viewer._dataSourceCollection._dataSources,e=s.length;for(let i=0;i<e;i++){const o=s.get(i);if(o._imageryProvider._layers===t){s.remove(o);return}}}removeAllLayers(){this.viewer.imageryLayers.removeAll()}getActiveLayers(){return this.viewer.imageryLayers._layers}setCamera(){const t=Cesium.Cartesian3.fromDegrees(8.909041078781357,44.410209942448475,4e3);this.viewer.camera.flyTo({destination:t,orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0}})}async addBuilding(){const t=await Cesium.createOsmBuildingsAsync();this.viewer.scene.primitives.add(t)}}const y=(a,t)=>{a.categories.forEach(s=>{const e=document.createElement("app-accordion");e.setAttribute("title",s.name),e.classList.add("category-accordion"),s.groups.forEach((i,o,r)=>{const c=document.createElement("app-accordion");o===r.length-1&&c.classList.add("last-accordion"),c.setAttribute("title",i.name),c.classList.add("layer-accordion");const l=document.createElement("app-checkbox-list");l.setAttribute("input",JSON.stringify(i.layers)),c.append(l),e.append(c),t.append(e)})})},_=(a,t)=>{a.categories.forEach(s=>{s.groups.forEach(e=>{e.layers=e.layers.filter(i=>i.tags?i.tags.some(o=>o.includes(t)):!1),e.layers.length===0&&(s.groups=s.groups.filter(i=>i!==e))}),s.groups.length===0&&(a.categories=a.categories.filter(e=>e!==s))})};async function B(a){const t=await fetch(a).then(e=>e.json()),s=t.categories;for(const e of s){const i=[];for(let r=0;r<e.groups.length;r++){let c=e.groups[r];const l=await fetch(c).then(n=>{if(n)return n.json()}).catch(n=>console.log(n));i.push(l)}const o=await Promise.all(i).then(r=>r);e.groups.splice(0,e.groups.length),o.forEach(r=>{e.groups.push(r)})}return t}const w=async(a,t,s)=>{for(const e of a)e.addEventListener("checkboxListChanged",async i=>{i.detail.input.forEach(c=>{const l=t.findIndex(n=>n.layer===c.layer);l!==-1&&t.splice(l,1)}),JSON.parse(i.detail.newValue).forEach(c=>{t.push(c)}),await s.viewer.dataSources.removeAll();for(const c of t)await s.addLayersWFS(c.layer_url_wfs,c.layer,c.style)})},F=(a,t)=>{if(a!=null){let s="";a.id.includes(".")&&(s=a.id.split(".")[0]);const e=L(t,s),i=e.name,o=e.relevant_properties;return D(a.properties,o,i)}};function L(a,t){for(const s in a){const e=a[s];if(Array.isArray(e)||typeof e=="object"){const i=L(e,t);if(i)return i}else if(typeof e=="string"&&e.includes(t))return a}return null}function D(a,t,s){const e={};if(t){for(const i of t)i.property_name&&a[i.property_name]&&(e[i.display_name]=a[i.property_name]._value);return e.Title=s,e}return e}const A=(a,t)=>{a.forEach(s=>{s.addEventListener("accordionChanged",e=>{a.forEach(i=>{i!=e.target&&i.setAttribute("is-active","false")}),t.forEach(i=>{i.setAttribute("is-active","false")})})}),t.forEach(s=>{s.addEventListener("accordionChanged",e=>{t.forEach(i=>{i!=e.target&&i.setAttribute("is-active","false")})})})},R=(a,t)=>{let s=[];return a.categories.forEach(i=>{i.groups.forEach(o=>{o.layers.forEach(r=>{r.tags&&r.tags.forEach(c=>{c.includes(t)&&s.push(c)})})})}),[...new Set(s)]};let C=0;function W(a,t,s){let e=!1;if(a.forEach(i=>{i.getAttribute("data")===JSON.stringify(t)&&(e=!0)}),!e&&t){const i=document.createElement("app-infobox");i.setAttribute("data",JSON.stringify(t)),C++,i.setAttribute("uuid",C),s.append(i)}}const z=[self.location.hostname,"fonts.gstatic.com","fonts.googleapis.com","cdn.jsdelivr.net"],U=a=>{var t=Date.now(),s=new URL(a.url);return s.protocol=self.location.protocol,s.hostname===self.location.hostname&&(s.search+=(s.search?"&":"?")+"cache-bust="+t),s.href};self.addEventListener("activate",a=>{a.waitUntil(self.clients.claim())});self.addEventListener("fetch",a=>{if(z.indexOf(new URL(a.request.url).hostname)>-1){const t=caches.match(a.request),s=U(a.request),e=fetch(s,{cache:"no-store"}),i=e.then(o=>o.clone());a.respondWith(Promise.race([e.catch(o=>t),t]).then(o=>o||e).catch(o=>{})),a.waitUntil(Promise.all([i,caches.open("pwa-cache")]).then(([o,r])=>o.ok&&r.put(a.request,o)).catch(o=>{}))}});class k extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="checkbox">
                <input type="checkbox" id="checkbox">
                <div class="legend"></div>
                <label for="checkbox">Label</label>
            </div>                      
            `,this.checkbox=this.shadow.querySelector("input"),this.hasAttribute("is-checked")&&this.getAttribute("is-checked")=="true"?(this.setAttribute("is-checked",this.getAttribute("is-checked")),this.checkbox.checked=!0):(this.setAttribute("is-checked","false"),this.checkbox.checked=!1),this.label=this.shadow.querySelector("label"),this.hasAttribute("data")&&(this.label.innerHTML=JSON.parse(this.getAttribute("data")).name),this.legend=this.shadow.querySelector(".legend");const t=JSON.parse(this.getAttribute("data")).style.color;this.legend.style.backgroundColor=t;const s=JSON.parse(this.getAttribute("data")).components;if(s!=null&&s.length!=0){this.details=document.createElement("details"),this.details.innerHTML=`
                <summary>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                    </svg>                
                </summary>
                `;for(const i of s)this.component=document.createElement(`${i}`),i=="app-opacity-slider"&&(this.opacity=JSON.parse(this.getAttribute("data")).style.opacity,this.component.setAttribute("opacity",this.opacity),this.component.addEventListener("opacityChanged",o=>{const r=JSON.parse(this.getAttribute("data"));r.style.opacity=o.detail.newValue,this.setAttribute("data",JSON.stringify(r))}));this.details.append(this.component),this.shadow.append(this.details)}this.checkbox.addEventListener("change",i=>{const o=i.target.checked;this.setAttribute("is-checked",o+"")});const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","./css/checkbox.css"),this.shadow.append(e)}attributeChangedCallback(t,s,e){if(t=="is-checked"&&s!==null&&e!==null&&e!==s){e=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1;const i=new CustomEvent("checkboxChanged",{detail:{name:t,oldValue:s,newValue:e}});this.toolOpacity=this.shadow.querySelector("app-opacity-slider"),this.toolOpacity&&this.toolOpacity.setAttribute("is-enable",e),this.dispatchEvent(i)}if(t=="data"&&e!==s){const i=new CustomEvent("opacityChanged",{detail:{name:t,oldValue:s,newValue:e}});this.dispatchEvent(i)}}}u(k,"observedAttributes",["is-checked","data"]);customElements.define("app-checkbox",k);class E extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div></div>
            `,this.div=this.shadow.querySelector("div"),this.setAttribute("all-active","false");const t=document.createElement("link");if(t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/checkbox-list.css"),this.shadow.append(t),!!this.hasAttribute("input")){this.input=JSON.parse(this.getAttribute("input")),this.data=[],this.checkboxes=[];for(let s=0;s<this.input.length;s++)this.checkbox=document.createElement("app-checkbox"),this.checkbox.setAttribute("is-checked","false"),this.checkbox.setAttribute("data",JSON.stringify(this.input[s])),this.checkboxes.push(this.checkbox),this.div.append(this.checkbox);this.checkboxes.forEach(s=>{s.addEventListener("checkboxChanged",()=>{this.itemData=JSON.parse(s.getAttribute("data"));const e=this.data.findIndex(i=>i.layer===this.itemData.layer);e!==-1?this.data.splice(e,1):this.data.push(this.itemData),this.setAttribute("data",JSON.stringify(this.data))})}),this.checkboxes.forEach(s=>{s.addEventListener("opacityChanged",e=>{this.itemData=JSON.parse(s.getAttribute("data")),this.itemData.opacity=e.detail.newValue;const i=this.data.findIndex(o=>o.layer===this.itemData.layer);i!==-1?(this.data.splice(i,1),this.data.push(this.itemData)):this.data.push(this.itemData),this.setAttribute("data",JSON.stringify(this.data))})})}}attributeChangedCallback(t,s,e){if(t=="data"&&e!=s){const i=new CustomEvent("checkboxListChanged",{detail:{name:"data",oldValue:s,newValue:e,input:this.input}});this.dispatchEvent(i)}t=="all-active"&&s!=null&&e!=null&&e!=s&&this.checkboxes.forEach(i=>{i.setAttribute("is-checked",this.getAttribute("all-active"))})}}u(E,"observedAttributes",["data","all-active"]);customElements.define("app-checkbox-list",E);class S extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="infobox">
                <div class="drag-handler">
                    <svg id="grip-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                    </svg>

                    <svg id="close-icon" viewPort="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <line x1="1" y1="11" x2="11" y2="1" stroke="black" stroke-width="2"/>
                        <line x1="1" y1="1" x2="11" y2="11" stroke="black" stroke-width="2"/>
                    </svg>
                </div>

                <div class="info-content"></div>
            </div>
            `;const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/infobox.css"),this.shadow.append(t),this.info=this.shadow.querySelector(".info-content"),this.data=JSON.parse(this.getAttribute("data"));const s={Title:this.data.Title};Object.keys(s).forEach(o=>{const r=s[o],c=document.createElement("h3");c.innerText=r,this.info.append(c)});const e={...this.data};delete e.Title,Object.keys(e).forEach(o=>{const r=e[o];this.text=document.createElement("p"),this.text.innerHTML=`
                <span class="info-key">${o}:</span> <span class="info-value">${r}</span>
                `,this.info.append(this.text)}),this.closeIcon=this.shadow.querySelector("#close-icon"),this.closeIcon.addEventListener("click",()=>{const o=new CustomEvent("infoboxRemoved",{detail:{uuid:this.getAttribute("uuid")}});this.dispatchEvent(o),this.remove()}),this.div=this.shadow.querySelector(".infobox"),this.dragHandler=this.shadow.querySelector(".drag-handler"),(o=>{let r=!1,c,l;this.dragHandler.addEventListener("mousedown",n=>{r=!0,c=n.clientX-o.getBoundingClientRect().left,l=n.clientY-o.getBoundingClientRect().top}),document.addEventListener("mousemove",n=>{r&&(o.style.left=n.clientX-c+"px",o.style.top=n.clientY-l+"px")}),document.addEventListener("mouseup",()=>{r=!1,this.setAttribute("position",JSON.stringify(o.getBoundingClientRect()))})})(this.div)}attributeChangedCallback(t,s,e){if(e!=s){const i=new CustomEvent("positionChanged",{detail:{name:t,oldValue:s,newValue:e}});this.dispatchEvent(i)}}}u(S,"observedAttributes",["position"]);customElements.define("app-infobox",S);class x extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.slots=this.shadow.querySelectorAll("slot"),this.slots.forEach(t=>{t.assignedNodes().forEach(e=>{(e.nodeName==="APP-ACCORDION"||e.tagName==="APP-ACCORDION")&&e.setAttribute("all-active",this.getAttribute("all-active")),(e.nodeName==="APP-CHECKBOX-LIST"||e.tagName==="APP-CHECKBOX-LIST")&&e.setAttribute("all-active",this.getAttribute("all-active"))})}),this.getAttribute("all-active")=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1}connectedCallback(){this.setAttribute("is-active","false"),this.setAttribute("all-active","false"),this.shadow.innerHTML=`
            
            <div class="accordion-item">

                <div class="accordion-checkbox">
                <input type="checkbox"></input>                

                <button type="button" class="accordion-btn">
                    <span class="accordion-title"></span>
                    <span class="accordion-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                        </svg>
                    </span>
                </button>

                </div>

                <div class="accordion-content">
                    <slot></slot>
                </div>
            </div>
            `,this.accordionTitle=this.shadow.querySelector(".accordion-title"),this.accordionTitle&&(this.accordionTitle.textContent=this.title),this.accordionContent=this.shadow.querySelector(".accordion-content"),this.accordionIcon=this.shadow.querySelector(".accordion-icon");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/accordion.css"),this.shadow.append(t),this.accordionBtn=this.shadow.querySelector(".accordion-btn"),this.accordionBtn.addEventListener("click",()=>{this.accordionContent=this.shadow.querySelector(".accordion-content"),this.getAttribute("is-active")==="true"?(this.setAttribute("is-active","false"),this.accordionContent.classList.remove("accordion-show"),this.accordionIcon.classList.remove("accordion-icon-active")):(this.setAttribute("is-active","true"),this.accordionContent.classList.add("accordion-show"),this.accordionIcon.classList.add("accordion-icon-active"));const s=new CustomEvent("accordionChanged",{detail:{name:"is-active",oldValue:this.getAttribute("is-active"),newValue:this.getAttribute("is-active")}});this.dispatchEvent(s)}),this.classList.contains("last-accordion")&&this.accordionContent.classList.add("last-accordion"),this.checkbox=this.shadow.querySelector('input[type="checkbox"]'),this.getAttribute("all-active")=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1,this.checkbox.addEventListener("change",s=>{const e=s.target.checked;this.setAttribute("all-active",e+"")})}attributeChangedCallback(t,s,e){t=="is-active"&&s!==null&&e!==null&&e!=s&&(this.getAttribute("is-active")==="true"?(this.accordionContent.classList.add("accordion-show"),this.accordionIcon.classList.add("accordion-icon-active")):(this.accordionContent.classList.remove("accordion-show"),this.accordionIcon.classList.remove("accordion-icon-active"))),t=="all-active"&&s!==null&&e!==null&&e!=s&&this.render()}}u(x,"observedAttributes",["is-active","all-active"]);customElements.define("app-accordion",x);class T extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.input&&(this.input.setAttribute("value",this.getAttribute("value")),this.input.value=this.getAttribute("value"))}connectedCallback(){this.shadow.innerHTML=`
            <input type="search" name="search" id="search" placeholder="Cerca per livelli..." value="">
            `,this.input=this.shadow.querySelector("input");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/search.css"),this.shadow.append(t),this.input.addEventListener("input",()=>{this.setAttribute("value",this.input.value)})}attributeChangedCallback(t,s,e){const i=new CustomEvent("searchValueChanged",{detail:{name:t,oldValue:s,newValue:e}});e!=s&&(this.dispatchEvent(i),this.render())}}u(T,"observedAttributes",["value"]);customElements.define("app-searchbar",T);class O extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <a id="menu-toggle" class="menu-toggle">
                <span class="menu-toggle-bar menu-toggle-bar--top"></span>
                <span class="menu-toggle-bar menu-toggle-bar--middle"></span>
                <span class="menu-toggle-bar menu-toggle-bar--bottom"></span>
            </a>
            `,this.setAttribute("is-open","false");let t=this.getAttribute("is-open");this.a=this.shadow.querySelector("a");const s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("href","./css/drawer-toggle.css"),this.shadow.append(s),this.a.addEventListener("click",()=>{t=this.getAttribute("is-open")==="true",this.setAttribute("is-open",!t+"")})}attributeChangedCallback(t,s,e){if(t==="is-open"){this.a&&(e==="true"?this.a.classList.add("nav-open"):this.a.classList.remove("nav-open"));const i=new CustomEvent("drawerToggled",{detail:{name:t,oldValue:s,newValue:e}});this.dispatchEvent(i)}}}u(O,"observedAttributes",["is-open"]);customElements.define("app-drawer-toggle",O);class q extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){if(this.tags=JSON.parse(this.getAttribute("data")),this.div.innerHTML="",this.tags)for(let t=0;t<this.tags.length;t++)this.span=document.createElement("span"),this.span.textContent=this.tags[t],this.span.setAttribute("name",this.tags[t]),this.span.setAttribute("tabindex",t+1),this.div.append(this.span);this.spans=this.shadow.querySelectorAll("span"),this.spans.forEach(t=>{t.addEventListener("click",()=>{this.setAttribute("selected",t.getAttribute("name"))})})}connectedCallback(){this.shadow.innerHTML=`
            <div></div>
            `,this.selectedSpan=0,this.div=this.shadow.querySelector("div"),this.setAttribute("selected","");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/autocomplete.css"),this.shadow.append(t)}attributeChangedCallback(t,s,e){if(t=="data"&&e!=s&&this.render(),t=="selected"&&e!=s){const i=new CustomEvent("autocompleteSelected",{detail:{name:t,oldValue:s,newValue:e}});this.dispatchEvent(i),this.div.innerHTML=""}t=="last-key-pressed"&&e!="Enter"&&e!="ArrowDown"&&e!="ArrowUp"&&(this.selectedSpan=0,this.render()),(t=="last-key-pressed"&&e=="ArrowUp"||e=="ArrowDown")&&(e=="ArrowDown"&&(this.selectedSpan++,this.selectedSpan==this.spans.length+1&&(this.selectedSpan=1),this.shadow.querySelector(`span[tabindex="${this.selectedSpan}"]`).focus()),e=="ArrowUp"&&(this.selectedSpan++,this.selectedSpan==this.spans.length+1&&(this.selectedSpan=1),this.shadow.querySelector(`span[tabindex="${this.selectedSpan}"]`).focus())),t=="last-key-pressed"&&e=="Enter"&&(this.setAttribute("selected",this.shadow.activeElement.getAttribute("name")),this.div.innerHTML="")}}u(q,"observedAttributes",["data","selected","last-key-pressed"]);customElements.define("app-autocomplete",q);class M extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.getAttribute("is-enable")=="true"?this.input.disabled=!1:this.input.disabled=!0}connectedCallback(){this.shadow.innerHTML=`
            <div>
                <label>Opacità</label>
                <input type="range">
            </div>
            `,this.input=this.shadow.querySelector("input"),this.hasAttribute("is-enable")||(this.setAttribute("is-enable","false"),this.input.disabled=!0),this.input.setAttribute("min",0),this.input.setAttribute("max",1),this.input.setAttribute("step",.1),this.input.value=this.getAttribute("opacity"),this.input.addEventListener("change",()=>{this.setAttribute("opacity",this.input.value)});const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/tool.css"),this.shadow.append(t)}attributeChangedCallback(t,s,e){if(t=="opacity"&&e!=s){const i=new CustomEvent("opacityChanged",{detail:{name:t,oldValue:s,newValue:e}});this.dispatchEvent(i)}t=="is-enable"&&s!==null&&e!==null&&e!==s&&this.render()}}u(M,"observedAttributes",["is-enable","opacity"]);customElements.define("app-opacity-slider",M);const $="./json/categories.json",m=new J;m.setCamera();const f=document.querySelector("#categories-section");B($).then(a=>(y(a,f),a)).then(a=>{const t=document.querySelector("main"),s=document.querySelector("app-drawer-toggle"),e=document.querySelector("#drawer"),i=document.querySelectorAll("app-checkbox-list"),o=document.querySelectorAll(".category-accordion"),r=document.querySelectorAll(".layer-accordion"),c=document.querySelector("app-searchbar"),l=document.querySelector("#drawer-title"),n=document.querySelector("app-autocomplete");s.addEventListener("drawerToggled",h=>{h.detail.newValue=="true"?e.classList.add("drawer-open"):e.classList.remove("drawer-open")}),m.viewer.screenSpaceEventHandler.setInputAction(function(h){m.onClick(h.position).then(d=>{const p=F(d,a);let v=document.querySelectorAll("app-infobox");p&&Object.keys(p).length!==0&&W(v,p,t),s.setAttribute("is-open","false")})},Cesium.ScreenSpaceEventType.LEFT_CLICK);const b=[];w(i,b,m),A(o,r),c.addEventListener("searchValueChanged",h=>{f.innerHTML="";const d=h.detail.newValue.toLowerCase();l.textContent=`Livelli per: ${d}`;let p=JSON.parse(JSON.stringify(a));if(_(p,d),d=="")y(a,f),l.textContent="Categorie";else if(y(p,f),!f.innerHTML){const g=document.createElement("p");g.innerText=`Nessun livello trovato per ${d}`,f.append(g)}const v=document.querySelectorAll("app-checkbox-list");w(v,b,m);const N=document.querySelectorAll(".category-accordion"),I=document.querySelectorAll(".layer-accordion");if(A(N,I),d.length>=2){const g=R(a,d);n.setAttribute("data",JSON.stringify(g))}else n.setAttribute("data",JSON.stringify(""))}),n.addEventListener("autocompleteSelected",h=>{const d=h.detail.newValue;c.setAttribute("value",d)}),document.addEventListener("keydown",h=>{n.setAttribute("last-key-pressed",h.key)})});
