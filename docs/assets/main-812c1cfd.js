var Z=Object.defineProperty;var V=(a,t,e)=>t in a?Z(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var p=(a,t,e)=>(V(a,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class tt{constructor(){const t=document.querySelector("app-map");Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxMmEyNDlkYS1iYTg4LTQ4MDktOTU0ZS05Yjg2ZTcyZGI1ZGMiLCJpZCI6MTY5MDU3LCJpYXQiOjE2OTU5MDI3ODB9.xSyAfYggSQ_UaYmqQLfI4Rf-Hl_Ip0ubYKLQakKadvA",this.viewer=new Cesium.Viewer(t,{baseLayerPicker:!1,geocoder:!1,timeline:!1,animation:!1,homeButton:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,sceneModePicker:!1,fullscreenButton:!1,infoBox:!1}),this.viewer.screenSpaceEventHandler.setInputAction(this.onClick.bind(this),Cesium.ScreenSpaceEventType.LEFT_CLICK)}changeTheme(t){const e=JSON.parse(t),s=new Cesium.WebMapTileServiceImageryProvider({url:e.url,layer:e.layer,style:"default",format:"image/jpeg",maximumLevel:19,tileMatrixSetID:"default",credit:new Cesium.Credit(e.credit)});this.viewer.imageryLayers.addImageryProvider(s)}static getImageryProvider(){return new Cesium.WebMapTileServiceImageryProvider({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{TileMatrix}/{TileCol}/{TileRow}.png",layer:"carto-light",style:"default",format:"image/jpeg",maximumLevel:19,tileMatrixSetID:"default",credit:new Cesium.Credit('&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>')})}async onClick(t){const e=this.viewer.scene.pick(t);if(e)return e.id}addLayerWMS(t,e){const s=new Cesium.WebMapServiceImageryProvider({url:t,layers:e});console.log(this.viewer.imageryLayers),this.viewer.imageryLayers.addImageryProvider(s),console.log(this.viewer.imageryLayers)}removeLayerWMS(t){const e=this.viewer.imageryLayers,s=e.length;for(let i=0;i<s;i++){const o=e.get(i);if(o._imageryProvider._layers===t){e.remove(o);return}}}addLayersWFS(t,e,s){let i="YELLOW",o="YELLOW",n="YELLOW",r=.5;s&&s.color&&(i=s.color.toUpperCase(),o=s.color.toUpperCase(),n=s.color.toUpperCase()),s&&s.opacity&&(r=s.opacity);const l=`${t}?service=WFS&typeName=${e}&outputFormat=application/json&request=GetFeature&srsname=EPSG:4326`;fetch(l).then(c=>c.json()).then(c=>{this.viewer.dataSources.add(Cesium.GeoJsonDataSource.load(c,{stroke:Cesium.Color[i].withAlpha(parseFloat(r)),strokeWidth:2,fill:Cesium.Color[o].withAlpha(parseFloat(r))})).then(u=>{u.entities.values.forEach(b=>{b.billboard=void 0,b.point=new Cesium.PointGraphics({pixelSize:18,color:Cesium.Color[n].withAlpha(parseFloat(r)),outlineColor:Cesium.Color[n].withAlpha(parseFloat(r)),outlineWidth:2})});const y=100,f=3,w=!0;u.clustering.enabled=w,u.clustering.pixelRange=y,u.clustering.minimumClusterSize=f;let m;Cesium.defined(m)?(m(),m=void 0):m=u.clustering.clusterEvent.addEventListener(function(b,h){h.billboard.show=!1,h.point.show=!0,h.point.pixelSize=48,b.length>=50?(h.point.color=Cesium.Color.RED.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.RED):b.length>=40?(h.point.color=Cesium.Color.ORANGE.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.ORANGE):b.length>=30?(h.point.color=Cesium.Color.YELLOW.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.YELLOW):b.length>=20?(h.point.color=Cesium.Color.GREEN.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.GREEN):b.length>=10?(h.point.color=Cesium.Color.BLUE.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.BLUE):(h.point.color=Cesium.Color.VIOLET.withAlpha(parseFloat(r)),h.point.outlineColor=Cesium.Color.VIOLET),h.label.show=!0,h.label.text=b.length.toLocaleString(),h.label.verticalOrigin=Cesium.VerticalOrigin.CENTER,h.label.horizontalOrigin=Cesium.HorizontalOrigin.CENTER,h.label.pixelOffset=new Cesium.Cartesian2(0,0),h.label.pixelOffsetScaleByDistance=void 0,h.label.position.z+=5})})})}removeLayerWFS(t){const e=this.viewer._dataSourceCollection._dataSources,s=e.length;for(let i=0;i<s;i++){const o=e.get(i);if(o._imageryProvider._layers===t){e.remove(o);return}}}removeAllLayers(){this.viewer.imageryLayers.removeAll()}getActiveLayers(){return this.viewer.imageryLayers._layers}createRoute(t,e,s){const i=[];t.forEach(n=>i.push(n)),e.forEach(n=>i.push(n));const o="#4A89F3";this.viewer.entities.add({name:`path-${s}`,polyline:{positions:Cesium.Cartesian3.fromDegreesArray(i),width:5,material:Cesium.Color.fromCssColorString(o),clampToGround:!0}})}createPointsOrderLabels(t,e){const s=t[0],i=t[1];this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(s,i,1),label:{text:`${e}`,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-20),scale:.5,scaleByDistance:new Cesium.NearFarScalar(150,1.5,8e6,0)}})}setCamera(){const t=Cesium.Cartesian3.fromDegrees(8.909041078781357,44.410209942448475,4e3);this.viewer.camera.flyTo({destination:t,orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0}})}setCameraToUserPosition(t){const e=Cesium.Cartesian3.fromDegrees(t.coords.longitude,t.coords.latitude,4e3);this.viewer.camera.flyTo({destination:e,orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0}})}createUserPin(t){this.viewer.entities.add({name:"Green cylinder with black outline",position:Cesium.Cartesian3.fromDegrees(t.coords.longitude,t.coords.latitude,20),cylinder:{length:40,topRadius:10,bottomRadius:10,material:Cesium.Color.GREEN.withAlpha(1)}})}async addBuilding(){const t=await Cesium.createOsmBuildingsAsync();this.viewer.scene.primitives.add(t)}}const et=async()=>new Promise((a,t)=>{navigator.geolocation.getCurrentPosition(e=>a(e),e=>t(e))}),L=(a,t)=>{a.categories.forEach(e=>{const s=document.createElement("app-accordion");s.setAttribute("title",e.name),s.classList.add("category-accordion"),e.groups.forEach((i,o,n)=>{const r=document.createElement("app-accordion");o===n.length-1&&r.classList.add("last-accordion"),r.setAttribute("title",i.name),r.classList.add("layer-accordion");const l=document.createElement("app-checkbox-list");l.setAttribute("input",JSON.stringify(i.layers)),r.append(l),s.append(r),t.append(s)})})},st=(a,t)=>{a.categories.forEach(e=>{e.groups.forEach(s=>{s.layers=s.layers.filter(i=>i.tags?i.tags.some(o=>o.includes(t)):!1),s.layers.length===0&&(e.groups=e.groups.filter(i=>i!==s))}),e.groups.length===0&&(a.categories=a.categories.filter(s=>s!==e))})};async function M(a){const t=await fetch(a).then(s=>s.json()),e=t.categories;for(const s of e){const i=[];for(let n=0;n<s.groups.length;n++){let r=s.groups[n];const l=await fetch(r).then(c=>{if(c)return c.json()}).catch(c=>console.log(c));i.push(l)}const o=await Promise.all(i).then(n=>n);s.groups.splice(0,s.groups.length),o.forEach(n=>{s.groups.push(n)})}return t}const S=async(a,t,e)=>{for(const s of a)s.addEventListener("checkboxListChanged",async i=>{i.detail.input.forEach(r=>{const l=t.findIndex(c=>c.layer===r.layer);l!==-1&&t.splice(l,1)}),s.getAttribute("navigation-data")!="null"&&s.setAttribute("navigation-data","null"),JSON.parse(i.detail.newValue).forEach(r=>{t.push(r)}),await e.viewer.dataSources.removeAll();for(const r of t)e.addLayersWFS(r.layer_url_wfs,r.layer,r.style)})},x=async(a,t,e,s)=>{const i=s.viewer.entities;if(N(i),e==null)return;const n=(await it(e)).features;let r=[t.coords.longitude,t.coords.latitude],l=1;for(;n.length!=0;){let c=1/0,u=-1;for(let f=0;f<n.length;f++){let w=n[f];const m=at(a,r,w);m<c&&(c=m,u=f)}const y=q(n[u]);s.createPointsOrderLabels(y,l),u!==-1&&n.splice(u,1),l++,r=y}s.viewer.zoomTo(s.viewer.entities)};async function it(a){const t=`${a.url}?service=WFS&typeName=${a.layer}&outputFormat=application/json&request=GetFeature&srsname=EPSG:4326`;try{return await(await fetch(t)).json()}catch(e){throw console.error("Errore durante la richiesta fetch:",e),e}}function at(a,t,e){const s=q(e),i=a.Cartographic.fromDegrees(t[0],t[1]),o=a.Cartographic.fromDegrees(s[0],s[1]);return new a.EllipsoidGeodesic(i,o).surfaceDistance}function q(a){let t=[];if(Array.isArray(a.geometry.coordinates)){let e=a.geometry.coordinates;e.length==1?e[0].forEach(s=>t.push(s)):(e.splice(2),e.forEach(s=>t.push(s)))}else t=[a.geometry.coordinates];return t}async function N(a){const t=Array.from(a.values);for(const e of t)e.polyline!==void 0&&await a.remove(e),e.label!==void 0&&await a.remove(e)}const ot=(a,t,e)=>{const s=nt(a,t,e),i=`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`;window.open(i,"_blank")};function nt(a,t,e){const s=t.viewer.scene.pickPosition(e),i=a.Cartographic.fromCartesian(s),o=a.Math.toDegrees(i.longitude),n=a.Math.toDegrees(i.latitude);return{longitude:o,latitude:n}}const rt=(a,t)=>{if(a!=null){let e="";switch(!0){case a.id.includes("."):e=a.id.split(".")[0];break;case a.id.includes("/"):e=a.id.split("/")[0];break}const s=I(t,e),i=s.name,o=s.relevant_properties;return ct(a.properties,o,i)}};function I(a,t){for(const e in a){const s=a[e];if(Array.isArray(s)||typeof s=="object"){const i=I(s,t);if(i)return i}else if(typeof s=="string"&&s.includes(t))return a}return null}async function ct(a,t,e){const s={};if(t){for(const i of t)i.property_name&&a[i.property_name]&&(s[i.display_name]=a[i.property_name]._value);return s.Title=e,s}return s}const T=(a,t)=>{a.forEach(e=>{e.addEventListener("accordionChanged",s=>{a.forEach(i=>{i!=s.target&&i.setAttribute("is-active","false")}),t.forEach(i=>{i.setAttribute("is-active","false")})})}),t.forEach(e=>{e.addEventListener("accordionChanged",s=>{t.forEach(i=>{i!=s.target&&i.setAttribute("is-active","false")})})})},lt=(a,t)=>{let e=[];return a.categories.forEach(i=>{i.groups.forEach(o=>{o.layers.forEach(n=>{n.tags&&n.tags.forEach(r=>{r.includes(t)&&e.push(r)})})})}),[...new Set(e)]};let O=0;function ht(a,t,e){let s=!1;if(a.forEach(i=>{i.getAttribute("data")===JSON.stringify(t)&&(s=!0)}),!s&&t){const i=document.createElement("app-infobox");i.setAttribute("data",JSON.stringify(t)),O++,i.setAttribute("uuid",O),e.append(i)}}const dt=(a,t)=>{switch(t.getAttribute("zoom-type")){case"in":t.addEventListener("click",()=>{a.viewer.camera.zoomIn(500)});break;case"out":t.addEventListener("click",()=>{a.viewer.camera.zoomOut(500)});break}},ut=(a,t)=>{const e=a.viewer.imageryLayers._layers[1];a.viewer.imageryLayers.remove(e),t!=""&&a.changeTheme(t)},pt=a=>{let t=[];a.categories.forEach(s=>{s.groups.forEach(i=>{i.layers.forEach(o=>{o.tags&&o.tags.forEach(n=>{t.push(n)})})})});const e=[...new Set(t)];return e.sort(),e},gt=(a,t)=>{a.categories.forEach(e=>{e.groups.forEach(s=>{s.layers=s.layers.filter(i=>i.tags?t.some(o=>i.tags.includes(o)):!1),s.layers.length===0&&(e.groups=e.groups.filter(i=>i!==s))}),e.groups.length===0&&(a.categories=a.categories.filter(s=>s!==e))})},mt=[self.location.hostname,"fonts.gstatic.com","fonts.googleapis.com","cdn.jsdelivr.net"],bt=a=>{var t=Date.now(),e=new URL(a.url);return e.protocol=self.location.protocol,e.hostname===self.location.hostname&&(e.search+=(e.search?"&":"?")+"cache-bust="+t),e.href};self.addEventListener("activate",a=>{a.waitUntil(self.clients.claim())});self.addEventListener("fetch",a=>{if(mt.indexOf(new URL(a.request.url).hostname)>-1){const t=caches.match(a.request),e=bt(a.request),s=fetch(e,{cache:"no-store"}),i=s.then(o=>o.clone());a.respondWith(Promise.race([s.catch(o=>t),t]).then(o=>o||s).catch(o=>{})),a.waitUntil(Promise.all([i,caches.open("pwa-cache")]).then(([o,n])=>o.ok&&n.put(a.request,o)).catch(o=>{}))}});class H extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="checkbox">
                <input type="checkbox" id="checkbox">
                <div class="legend"></div>
                <label for="checkbox">Label</label>
            </div>                      
            `,this.checkbox=this.shadow.querySelector("input"),this.hasAttribute("is-checked")&&this.getAttribute("is-checked")=="true"?(this.setAttribute("is-checked",this.getAttribute("is-checked")),this.checkbox.checked=!0):(this.setAttribute("is-checked","false"),this.checkbox.checked=!1),this.label=this.shadow.querySelector("label"),this.hasAttribute("data")&&(this.label.innerHTML=JSON.parse(this.getAttribute("data")).name),this.legend=this.shadow.querySelector(".legend");const t=JSON.parse(this.getAttribute("data")).style.color;this.legend.style.backgroundColor=t;const e=JSON.parse(this.getAttribute("data")).components;if(e!=null&&e.length!=0){this.details=document.createElement("details"),this.details.innerHTML=`
                <summary>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                    </svg>                
                </summary>
                `;for(const i of e)this.component=document.createElement(`${i}`),i=="app-opacity-slider"&&(this.opacity=JSON.parse(this.getAttribute("data")).style.opacity,this.component.setAttribute("opacity",this.opacity),this.component.addEventListener("opacityChanged",o=>{const n=JSON.parse(this.getAttribute("data"));n.style.opacity=o.detail.newValue,this.setAttribute("data",JSON.stringify(n))})),i=="app-navigation-btn"&&this.component.addEventListener("routeTriggered",()=>{const o=JSON.parse(this.getAttribute("data")).layer,n=JSON.parse(this.getAttribute("data")).layer_url_wfs,r=new CustomEvent("routeTriggered",{detail:{layer:o,url:n}});this.dispatchEvent(r)}),this.details.append(this.component);this.shadow.append(this.details),this.setAttribute("is-details-open","false")}this.checkbox.addEventListener("change",i=>{const o=i.target.checked;this.setAttribute("is-checked",o+"")}),this.details&&this.details.addEventListener("toggle",i=>{i.target.open?this.setAttribute("is-details-open","true"):this.setAttribute("is-details-open","false")});const s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("href","./css/checkbox.css"),this.shadow.append(s)}attributeChangedCallback(t,e,s){if(t=="is-checked"&&e!==null&&s!==null&&s!==e){s=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1;const i=new CustomEvent("checkboxChanged",{detail:{name:t,oldValue:e,newValue:s}});this.toolOpacity=this.shadow.querySelector("app-opacity-slider"),this.toolOpacity&&this.toolOpacity.setAttribute("is-enable",s),this.toolRoute=this.shadow.querySelector("app-navigation-btn"),this.toolRoute&&this.toolRoute.setAttribute("is-enable",s),this.dispatchEvent(i)}if(t=="data"&&s!==e){const i=new CustomEvent("opacityChanged",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}if(t=="is-details-open"&&e!=null&&s!=null&&s!=e){const i=new CustomEvent("detailStatusChanged",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i),this.getAttribute("is-details-open")=="true"?this.details.setAttribute("open",""):this.details.removeAttribute("open")}}}p(H,"observedAttributes",["is-checked","data","is-details-open","is-route-active"]);customElements.define("app-checkbox",H);class P extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div></div>
            `,this.div=this.shadow.querySelector("div"),this.setAttribute("all-active","false");const t=document.createElement("link");if(t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/checkbox-list.css"),this.shadow.append(t),!!this.hasAttribute("input")){this.input=JSON.parse(this.getAttribute("input")),this.data=[],this.checkboxes=[];for(let e=0;e<this.input.length;e++)this.checkbox=document.createElement("app-checkbox"),this.checkbox.setAttribute("is-checked","false"),this.checkbox.setAttribute("data",JSON.stringify(this.input[e])),this.checkboxes.push(this.checkbox),this.div.append(this.checkbox);this.checkboxes.forEach(e=>{e.addEventListener("checkboxChanged",s=>{this.itemData=JSON.parse(e.getAttribute("data"));const i=this.data.findIndex(o=>o.layer===this.itemData.layer);i!==-1?this.data.splice(i,1):this.data.push(this.itemData),this.setAttribute("data",JSON.stringify(this.data))}),e.addEventListener("opacityChanged",s=>{this.itemData=JSON.parse(e.getAttribute("data")),this.itemData.opacity=s.detail.newValue;const i=this.data.findIndex(o=>o.layer===this.itemData.layer);i!==-1?(this.data.splice(i,1),this.data.push(this.itemData)):this.data.push(this.itemData),this.setAttribute("data",JSON.stringify(this.data))}),e.addEventListener("routeTriggered",s=>{this.setAttribute("navigation-data",JSON.stringify(s.detail))}),e.addEventListener("detailStatusChanged",s=>{s.detail.newValue=="true"&&this.checkboxes.forEach(i=>{i!==e&&i.setAttribute("is-details-open","false")})})})}}attributeChangedCallback(t,e,s){if(t=="data"&&s!=e){const i=new CustomEvent("checkboxListChanged",{detail:{name:"data",oldValue:e,newValue:s,input:this.input}});this.dispatchEvent(i)}if(t=="navigation-data"&&e!=null&&s!=null&&s!=e){const i=new CustomEvent("navigationTriggered",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}t=="all-active"&&e!=null&&s!=null&&s!=e&&this.checkboxes.forEach(i=>{i.setAttribute("is-checked",this.getAttribute("all-active"))})}}p(P,"observedAttributes",["data","all-active","navigation-data"]);customElements.define("app-checkbox-list",P);class z extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="infobox">
                <div class="drag-handler">
                    <svg id="grip-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                    </svg>

                    <svg id="close-icon" viewPort="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <line x1="1" y1="11" x2="11" y2="1" stroke="black" stroke-width="2"/>
                        <line x1="1" y1="1" x2="11" y2="11" stroke="black" stroke-width="2"/>
                    </svg>
                </div>

                <div class="info-content"></div>
            </div>
            `;const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/infobox.css"),this.shadow.append(t),this.info=this.shadow.querySelector(".info-content"),this.data=JSON.parse(this.getAttribute("data"));const e={Title:this.data.Title};Object.keys(e).forEach(o=>{const n=e[o],r=document.createElement("h3");r.innerText=n,this.info.append(r)});const s={...this.data};delete s.Title,Object.keys(s).forEach(o=>{const n=s[o];this.text=document.createElement("p"),this.text.innerHTML=`
                <span class="info-key">${o}:</span> <span class="info-value">${n}</span>
                `,this.info.append(this.text)}),this.closeIcon=this.shadow.querySelector("#close-icon"),this.closeIcon.addEventListener("click",()=>{const o=new CustomEvent("infoboxRemoved",{detail:{uuid:this.getAttribute("uuid")}});this.dispatchEvent(o),this.remove()}),this.div=this.shadow.querySelector(".infobox"),this.dragHandler=this.shadow.querySelector(".drag-handler"),(o=>{let n=!1,r,l;this.dragHandler.addEventListener("mousedown",c=>{n=!0,r=c.clientX-o.getBoundingClientRect().left,l=c.clientY-o.getBoundingClientRect().top}),document.addEventListener("mousemove",c=>{n&&(o.style.left=c.clientX-r+"px",o.style.top=c.clientY-l+"px")}),document.addEventListener("mouseup",()=>{n=!1,this.setAttribute("position",JSON.stringify(o.getBoundingClientRect()))})})(this.div)}attributeChangedCallback(t,e,s){if(s!=e){const i=new CustomEvent("positionChanged",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}}}p(z,"observedAttributes",["position"]);customElements.define("app-infobox",z);class D extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.slots.forEach(t=>{t.assignedNodes().forEach(s=>{(s.nodeName==="APP-ACCORDION"||s.tagName==="APP-ACCORDION")&&s.setAttribute("all-active",this.getAttribute("all-active")),(s.nodeName==="APP-CHECKBOX-LIST"||s.tagName==="APP-CHECKBOX-LIST")&&s.setAttribute("all-active",this.getAttribute("all-active"))})}),this.getAttribute("all-active")=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1}connectedCallback(){this.setAttribute("is-active","false"),this.setAttribute("all-active","false"),this.shadow.innerHTML=`
            
            <div class="accordion-item">

                <div class="accordion-checkbox">
                <input type="checkbox"></input>                

                <button type="button" class="accordion-btn">
                    <span class="accordion-title"></span>
                    <span class="accordion-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                        </svg>
                    </span>
                </button>

                </div>

                <div class="accordion-content">
                    <slot></slot>
                </div>
            </div>
            `,this.accordionTitle=this.shadow.querySelector(".accordion-title"),this.accordionTitle&&(this.accordionTitle.textContent=this.title),this.accordionContent=this.shadow.querySelector(".accordion-content"),this.accordionIcon=this.shadow.querySelector(".accordion-icon");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/accordion.css"),this.shadow.append(t),this.accordionBtn=this.shadow.querySelector(".accordion-btn"),this.accordionBtn.addEventListener("click",()=>{this.accordionContent=this.shadow.querySelector(".accordion-content"),this.getAttribute("is-active")==="true"?(this.setAttribute("is-active","false"),this.accordionContent.classList.remove("accordion-show"),this.accordionIcon.classList.remove("accordion-icon-active")):(this.setAttribute("is-active","true"),this.accordionContent.classList.add("accordion-show"),this.accordionIcon.classList.add("accordion-icon-active"));const e=new CustomEvent("accordionChanged",{detail:{name:"is-active",oldValue:this.getAttribute("is-active"),newValue:this.getAttribute("is-active")}});this.dispatchEvent(e)}),this.classList.contains("last-accordion")&&this.accordionContent.classList.add("last-accordion"),this.checkbox=this.shadow.querySelector('input[type="checkbox"]'),this.getAttribute("all-active")=="true"?this.checkbox.checked=!0:this.checkbox.checked=!1,this.checkbox.addEventListener("change",e=>{const s=e.target.checked;this.setAttribute("all-active",s+"")}),this.slots=this.shadow.querySelectorAll("slot")}attributeChangedCallback(t,e,s){t=="is-active"&&e!==null&&s!==null&&s!=e&&(this.getAttribute("is-active")==="true"?(this.accordionContent.classList.add("accordion-show"),this.accordionIcon.classList.add("accordion-icon-active")):(this.accordionContent.classList.remove("accordion-show"),this.accordionIcon.classList.remove("accordion-icon-active"))),t=="all-active"&&e!==null&&s!==null&&s!=e&&this.render()}}p(D,"observedAttributes",["is-active","all-active"]);customElements.define("app-accordion",D);class R extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.input&&(this.input.setAttribute("value",this.getAttribute("value")),this.input.value=this.getAttribute("value"))}connectedCallback(){this.shadow.innerHTML=`
            <input type="search" name="search" id="search" placeholder="Cerca per livelli..." value="">
            `,this.input=this.shadow.querySelector("input");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/search.css"),this.shadow.append(t),this.input.addEventListener("input",()=>{this.setAttribute("value",this.input.value)})}attributeChangedCallback(t,e,s){const i=new CustomEvent("searchValueChanged",{detail:{name:t,oldValue:e,newValue:s}});s!=e&&(this.dispatchEvent(i),this.render())}}p(R,"observedAttributes",["value"]);customElements.define("app-searchbar",R);class J extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="menu-toggle">
                <a id="menu-toggle">
                    <span class="menu-toggle-bar menu-toggle-bar--top"></span>
                    <span class="menu-toggle-bar menu-toggle-bar--middle"></span>
                    <span class="menu-toggle-bar menu-toggle-bar--bottom"></span>
                </a>
            </div>
            `,this.setAttribute("is-open","false");let t=this.getAttribute("is-open");this.btn=this.shadow.querySelector(".menu-toggle");const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","./css/drawer-toggle.css"),this.shadow.append(e),this.btn.addEventListener("click",()=>{t=this.getAttribute("is-open")==="true",this.setAttribute("is-open",!t+"")})}attributeChangedCallback(t,e,s){if(t==="is-open"){this.btn&&(s==="true"?this.btn.classList.add("nav-open"):this.btn.classList.remove("nav-open"));const i=new CustomEvent("drawerToggled",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}}}p(J,"observedAttributes",["is-open"]);customElements.define("app-drawer-toggle",J);class B extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){if(this.tags=JSON.parse(this.getAttribute("data")),this.div.innerHTML="",this.tags)for(let t=0;t<this.tags.length;t++)this.span=document.createElement("span"),this.span.textContent=this.tags[t],this.span.setAttribute("name",this.tags[t]),this.span.setAttribute("tabindex",t+1),this.div.append(this.span);this.spans=this.shadow.querySelectorAll("span"),this.spans.forEach(t=>{t.addEventListener("click",()=>{this.setAttribute("selected",t.getAttribute("name"))})})}connectedCallback(){this.shadow.innerHTML=`
            <div></div>
            `,this.selectedSpan=0,this.div=this.shadow.querySelector("div"),this.setAttribute("selected","");const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/autocomplete.css"),this.shadow.append(t)}attributeChangedCallback(t,e,s){if(t=="data"&&s!=e&&this.render(),t=="selected"&&s!=e){const i=new CustomEvent("autocompleteSelected",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i),this.div.innerHTML=""}t=="last-key-pressed"&&s!="Enter"&&s!="ArrowDown"&&s!="ArrowUp"&&(this.selectedSpan=0,this.render()),(t=="last-key-pressed"&&s=="ArrowUp"||s=="ArrowDown")&&(s=="ArrowDown"&&(this.selectedSpan++,this.selectedSpan==this.spans.length+1&&(this.selectedSpan=1),this.shadow.querySelector(`span[tabindex="${this.selectedSpan}"]`).focus()),s=="ArrowUp"&&(this.selectedSpan++,this.selectedSpan==this.spans.length+1&&(this.selectedSpan=1),this.shadow.querySelector(`span[tabindex="${this.selectedSpan}"]`).focus())),t=="last-key-pressed"&&s=="Enter"&&(this.setAttribute("selected",this.shadow.activeElement.getAttribute("name")),this.div.innerHTML="")}}p(B,"observedAttributes",["data","selected","last-key-pressed"]);customElements.define("app-autocomplete",B);class _ extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.getAttribute("is-enable")=="true"?this.input.disabled=!1:this.input.disabled=!0}connectedCallback(){this.shadow.innerHTML=`
            <div>
                <label>Opacità</label>
                <input type="range">
            </div>
            `,this.input=this.shadow.querySelector("input"),this.hasAttribute("is-enable")||(this.setAttribute("is-enable","false"),this.input.disabled=!0),this.input.setAttribute("min",0),this.input.setAttribute("max",1),this.input.setAttribute("step",.1),this.input.value=this.getAttribute("opacity"),this.input.addEventListener("change",()=>{this.setAttribute("opacity",this.input.value)});const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/tool.css"),this.shadow.append(t)}attributeChangedCallback(t,e,s){if(t=="opacity"&&s!=e){const i=new CustomEvent("opacityChanged",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}t=="is-enable"&&e!==null&&s!==null&&s!==e&&this.render()}}p(_,"observedAttributes",["is-enable","opacity"]);customElements.define("app-opacity-slider",_);class F extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div>
                <label>Percorso</label>
                <button type="button">Indicazioni</button>
            </div>
            `,this.btn=this.shadow.querySelector("button"),this.hasAttribute("is-enable")||(this.setAttribute("is-enable","false"),this.btn.disabled=!0),this.btn.addEventListener("click",()=>{const e=new CustomEvent("routeTriggered");this.dispatchEvent(e)});const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/activate-navigation-btn.css"),this.shadow.append(t)}attributeChangedCallback(t,e,s){t=="is-enable"&&e!==null&&s!==null&&s!==e&&(this.getAttribute("is-enable")=="true"?this.btn.disabled=!1:this.btn.disabled=!0,this.getAttribute("is-enable")=="false"&&this.setAttribute("is-route-active","false"))}}p(F,"observedAttributes",["is-enable"]);customElements.define("app-navigation-btn",F);class U extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){this.getAttribute("is-selected")=="true"?(this.chip.classList.add("selected"),this.checkbox.checked=!0):(this.chip.classList.remove("selected"),this.checkbox.checked=!1)}connectedCallback(){this.shadow.innerHTML=`
            <label for="chip">
                <input type="checkbox" id="chip">
                <span class="chip-title"></span>               
            </label>
            `,this.chip=this.shadow.querySelector("label"),this.span=this.shadow.querySelector("span"),this.checkbox=this.shadow.querySelector("input"),this.hasAttribute("tag")&&(this.span.innerText=this.getAttribute("tag"));const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/chip.css"),this.shadow.append(t),this.checkbox.addEventListener("change",e=>{const s=e.target.checked;this.setAttribute("is-selected",s+"")})}attributeChangedCallback(t,e,s){if(t=="is-selected"&&s!=e){const i=new CustomEvent("chipChanged",{detail:{name:t,newValue:s,oldValue:e,tag:this.getAttribute("tag")}});this.dispatchEvent(i),this.render()}}}p(U,"observedAttributes",["is-selected"]);customElements.define("app-chip",U);class W extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){JSON.parse(this.getAttribute("tags")).length===0?this.btn.disabled=!0:this.btn.disabled=!1}connectedCallback(){this.shadow.innerHTML=`
            <button type="submit">Submit</button>
            `,this.btn=this.shadow.querySelector("button"),this.hasAttribute("tags")||(this.btn.disabled=!0),this.btn.addEventListener("click",()=>{localStorage.setItem("selectedTags",this.getAttribute("tags")),window.location.href="/raise/map.html"});const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/button.css"),this.shadow.append(t)}attributeChangedCallback(t,e,s){t=="tags"&&s!=e&&this.render()}}p(W,"observedAttributes",["tags"]);customElements.define("app-btn",W);class G extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <a href="${this.hasAttribute("link")?this.getAttribute("link"):"/"}">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
                    <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                    <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                </svg>
            </a>
            `;const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/icon.css"),this.shadow.append(t)}attributeChangedCallback(){}}p(G,"observedAttributes",[]);customElements.define("app-icon-btn",G);class j extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){switch(this.shadow.innerHTML=`
            <div class="zoom-icon"></div>
            `,this.div=this.shadow.querySelector(".zoom-icon"),this.getAttribute("zoom-type")){case"in":this.div.innerHTML=`
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    `;break;case"out":this.div.innerHTML=`
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-dash" viewBox="0 0 16 16">
                        <path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/>
                    </svg>
                    `;break}const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/zoom-button.css"),this.shadow.append(t)}attributeChangedCallback(){}}p(j,"observedAttributes",[]);customElements.define("app-zoom-btn",j);class Y extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div id="change-theme-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-palette2" viewBox="0 0 16 16">
                    <path d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 .5.5v5.277l4.147-4.131a.5.5 0 0 1 .707 0l3.535 3.536a.5.5 0 0 1 0 .708L10.261 10H15.5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5H3a2.99 2.99 0 0 1-2.121-.879A2.99 2.99 0 0 1 0 13.044m6-.21 7.328-7.3-2.829-2.828L6 7.188v5.647zM4.5 13a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0zM15 15v-4H9.258l-4.015 4H15zM0 .5v12.495V.5z"/>
                    <path d="M0 12.995V13a3.07 3.07 0 0 0 0-.005z"/>
                </svg>
            </div>
            `;const t=[{},{url:"https://{s}.basemaps.cartocdn.com/light_all/{TileMatrix}/{TileCol}/{TileRow}.png",layer:"carto-light",credit:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'},{url:"https://{s}.basemaps.cartocdn.com/dark_all/{TileMatrix}/{TileCol}/{TileRow}.png",layer:"carto-dark",credit:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}];let e=0;this.setAttribute("theme",""),this.div=this.shadow.querySelector("#change-theme-icon"),this.div.addEventListener("click",()=>{if(e=(e+1)%t.length,e===0)this.setAttribute("theme","");else{const i=JSON.stringify(t[e]);this.setAttribute("theme",i)}});const s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("href","./css/theme-icon.css"),this.shadow.append(s)}attributeChangedCallback(t,e,s){if(t=="theme"&&s!=e&&e!=null&&s!=null){const i=new CustomEvent("themeChanged",{detail:{name:t,oldValue:e,newValue:s}});this.dispatchEvent(i)}}}p(Y,"observedAttributes",["theme"]);customElements.define("app-theme-icon",Y);class $ extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}render(){}connectedCallback(){this.shadow.innerHTML=`
            <div class="close-navigation-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-slash-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708z"/>
                </svg>
            </div>
            `,this.hasAttribute("is-active")||this.setAttribute("is-active",!1);const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","./css/close-navigation-btn.css"),this.shadow.append(t)}attributeChangedCallback(t,e,s){t=="is-active"&&e!=null&&s!=null&&s!=e&&this.classList.toggle("show")}}p($,"observedAttributes",["is-active"]);customElements.define("app-close-navigation-btn",$);const X="./json/categories.json";async function ft(){const a=new tt,t=await et();a.setCameraToUserPosition(t),a.createUserPin(t),document.querySelectorAll("app-zoom-btn").forEach(d=>dt(a,d)),document.querySelector("app-theme-icon").addEventListener("themeChanged",d=>ut(a,d.detail.newValue));const i=document.querySelector("#categories-section");let o=await M(X);if(localStorage.length!=0){let d=JSON.parse(JSON.stringify(o));gt(d,JSON.parse(localStorage.selectedTags)),L(d,i),o=d}else L(o,i);const n=document.querySelector("main"),r=document.querySelector("app-drawer-toggle"),l=document.querySelector("#drawer"),c=document.querySelectorAll("app-checkbox-list"),u=document.querySelectorAll(".category-accordion"),y=document.querySelectorAll(".layer-accordion"),f=document.querySelector("app-searchbar"),w=document.querySelector("#drawer-title"),m=document.querySelector("app-autocomplete");r.addEventListener("drawerToggled",d=>{d.detail.newValue=="true"?l.classList.add("drawer-open"):l.classList.remove("drawer-open")}),a.viewer.screenSpaceEventHandler.setInputAction(function(d){const g=d.position;a.onClick(g).then(async v=>{if(typeof v=="object"&&!Array.isArray(v))if(A==!1){const C=await rt(v,o);let k=document.querySelectorAll("app-infobox");C&&Object.keys(C).length!==0&&ht(k,C,n),r.setAttribute("is-open","false")}else ot(Cesium,a,g)})},Cesium.ScreenSpaceEventType.LEFT_CLICK);const b=[];S(c,b,a),T(u,y);const h=document.querySelector("app-close-navigation-btn");h.addEventListener("click",()=>{c.forEach(d=>d.setAttribute("navigation-data",null))});let A=!1;for(const d of c)d.addEventListener("navigationTriggered",g=>{if(g.detail.newValue!="null"){A=!0,h.setAttribute("is-active",A+"");const v=JSON.parse(g.detail.newValue);x(Cesium,t,v,a)}else A=!1,h.setAttribute("is-active",A+""),N(a.viewer.entities)});f.addEventListener("searchValueChanged",d=>{i.innerHTML="";const g=d.detail.newValue.toLowerCase();w.textContent=`Livelli per: ${g}`;let v=JSON.parse(JSON.stringify(o));if(st(v,g),g=="")L(o,i),w.textContent="Categorie";else if(L(v,i),!i.innerHTML){const E=document.createElement("p");E.innerText=`Nessun livello trovato per ${g}`,i.append(E)}const C=document.querySelectorAll("app-checkbox-list");S(C,b,a);const k=document.querySelectorAll(".category-accordion"),Q=document.querySelectorAll(".layer-accordion");if(T(k,Q),x(Cesium,t,C,a),g.length>=2){const E=lt(o,g);m.setAttribute("data",JSON.stringify(E))}else m.setAttribute("data",JSON.stringify(""))}),m.addEventListener("autocompleteSelected",d=>{const g=d.detail.newValue;f.setAttribute("value",g)}),document.addEventListener("keydown",d=>{m.setAttribute("last-key-pressed",d.key)})}async function vt(){let a=await M(X);pt(a).forEach(l=>{let c=document.createElement("app-chip");c.setAttribute("tag",l),K.append(c)});let e=[];const s=document.querySelectorAll("app-chip"),i=document.querySelector("app-btn");s.forEach(l=>{l.addEventListener("chipChanged",c=>{c.detail.newValue=="true"?e.push(c.detail.tag):e=e.filter(u=>u!==c.detail.tag),i.setAttribute("tags",JSON.stringify(e))})}),localStorage.selectedTags&&JSON.parse(localStorage.selectedTags).forEach(c=>{s.forEach(u=>{u.getAttribute("tag")==c&&u.setAttribute("is-selected","true")})}),document.querySelector("#select-all-btn").addEventListener("click",()=>{s.forEach(l=>{l.setAttribute("is-selected","true")})}),document.querySelector("#reset-btn").addEventListener("click",()=>{s.forEach(l=>{l.setAttribute("is-selected","false")})}),document.querySelector("#clear-local-storage").addEventListener("click",()=>localStorage.clear())}const yt=document.querySelector("app-map");yt&&ft();const K=document.querySelector("#chips-section");K&&vt();
